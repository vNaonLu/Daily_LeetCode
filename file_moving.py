#!python3
import os
import pathlib
from tools.utils import code_snippet
from tools.utils import local
from tools.leetcode.question import LeetCodeQuestion
from tools.leetcode import request as Rq
import re


def _main():
    lists = local.solved_question_ids("src")
    print(lists)
    for id in lists:
        print(id)
        _q = local.QuestionSource(id, "src")
        if pathlib.Path(_q.src()).exists():
            continue
        slug = Rq.question_slug(id)

        content = None
        with open(_q.path()
                .joinpath("q{}.hpp".format(str(_q.id()).zfill(4)))
                .resolve(), 'r') as f:
            content = code_snippet.code_snippet(f.read())
            content = re.sub("  ", "    ", content)

        if slug:
            q = LeetCodeQuestion(slug, True, content)
            s = q.template("This file is generated by leetcode_add.py v1.0", 70)
            with open(_q.src(), "w") as f:
                f.write(s)
            # return


if __name__ == "__main__":
    _main()
